{"$id": "https://example.com/schema/ASimDnsActivityLogs.json", "$schema": "http://json-schema.org/draft-07/schema#", "title": "ASimDnsActivityLogs", "description": "JSON Schema for Log Analytics table: ASimDnsActivityLogs", "type": "object", "required": ["TimeGenerated", "Type"], "$defs": {"time": {"anyOf": [{"type": "string", "format": "date-time"}, {"type": "string", "pattern": "\\d{10,13}(\\.\\d{1,3})?"}]}}, "properties": {"AdditionalFields": {"type": "string", "description": "Additional information, represented using key/value pairs provided by the source which do not map to ASim."}, "DnsFlags": {"type": "string", "description": "The DNS request flags, as provided by the reporting device.  The structure of the DNS flags information may vary between different reporting devices."}, "DnsFlagsAuthenticated": {"type": "boolean", "description": "The DNS authenticated answer flag, which is related to DNSSEC, indicates in a response that all data included in the answer and authority sections of the response have been verified by the server according to the policies of that server. see RFC 3655 Section 6.1 for more information."}, "DnsFlagsAuthoritative": {"type": "boolean", "description": "The DNS authoritative answer flag indicates whether the response from the server was authoritative."}, "DnsFlagsCheckingDisabled": {"type": "boolean", "description": "The DNS CD flag, which is related to DNSSEC, indicates in a query that non-verified data is acceptable to the system sending the query."}, "DnsFlagsRecursionAvailable": {"type": "boolean", "description": "The DNS RA flag indicates in a response that that server supports recursive queries."}, "DnsFlagsRecursionDesired": {"type": "boolean", "description": "The DNS recursion desired flag indicates in a request that that client would like the server to use recursive queries."}, "DnsFlagsTruncated": {"type": "boolean", "description": "The DNS TC flag indicates that a response was truncates as it exceeded the maximum response size."}, "DnsFlagsZ": {"type": "boolean", "description": "The DNS Z flag is a deprecated DNS flag, which might be reported by older DNS systems."}, "DnsNetworkDuration": {"type": "integer", "description": "The amount of time, in milliseconds, for the completion of DNS request."}, "DnsQuery": {"type": "string", "description": "The domain that needs to be resolved."}, "DnsQueryClass": {"type": "integer", "description": "The DNS class ID as defined by the Internet Assigned Numbers Authority (IANA)."}, "DnsQueryClassName": {"type": "string", "description": "The DNS class name as defined by the Internet Assigned Numbers Authority (IANA)."}, "DnsQueryType": {"type": "integer", "description": "The DNS resource record type codes as defined by the Internet Assigned Numbers Authority (IANA)."}, "DnsQueryTypeName": {"type": "string", "description": "The DNS resource record type name as defined by the Internet Assigned Numbers Authority (IANA)."}, "DnsResponseCode": {"type": "integer", "description": "The DNS numerical response code as defined by the Internet Assigned Numbers Authority (IANA)."}, "DnsResponseIpCity": {"type": "string", "description": "The city associated with the response IP address."}, "DnsResponseIpCountry": {"type": "string", "description": "The country associated with the response IP address."}, "DnsResponseIpLatitude": {"type": "number", "description": "The Latitude of the geographical coordinate associated with the response IP address."}, "DnsResponseIpLongitude": {"type": "number", "description": "The longitude of the geographical coordinate associated with the response IP address."}, "DnsResponseIpRegion": {"type": "string", "description": "The region, or state, within a country, associated with the source IP address."}, "DnsResponseName": {"type": "string", "description": "The content of the response, as included in the record. The structure of the DNS response data may vary between different reporting devices."}, "DnsSessionId": {"type": "string", "description": "The DNS session identifier as reported by the reporting device."}, "Dst": {"type": "string", "description": "A unique identifier of the server that received the DNS request."}, "DstDescription": {"type": "string", "description": "A descriptive text associated with the destination."}, "DstDeviceType": {"type": "string", "description": "The type of the destination device."}, "DstDomain": {"type": "string", "description": "The domain of the destination device."}, "DstDomainType": {"type": "string", "description": "The type of DstDomain."}, "DstDvcId": {"type": "string", "description": "The ID of the destination device."}, "DstDvcIdType": {"type": "string", "description": "The type of DstDvcId."}, "DstDvcScope": {"type": "string", "description": "The cloud platform scope the destination device belongs to. DvcScope maps to a subscription on Azure and to an account on AWS."}, "DstDvcScopeId": {"type": "string", "description": "The cloud platform scope ID the destination device belongs to. DvcScopeId map to a subscription ID on Azure and to an account ID on AWS."}, "DstFQDN": {"type": "string", "description": "The destination device hostname, including domain information when available."}, "DstGeoCity": {"type": "string", "description": "The city associated with the destination IP address."}, "DstGeoCountry": {"type": "string", "description": "The country associated with the destination IP address."}, "DstGeoLatitude": {"type": "number", "description": "The latitude of the geographical coordinate associated with the destination IP address."}, "DstGeoLongitude": {"type": "number", "description": "The longitude of the geographical coordinate associated with the destination IP address."}, "DstGeoRegion": {"type": "string", "description": "The region, or state, within a country, associated with the destination IP address."}, "DstHostname": {"type": "string", "description": "The destination device hostname, excluding domain information."}, "DstIpAddr": {"type": "string", "description": "The IP address of the server receiving the DNS request. For a regular DNS request, this value would typically be the reporting device, and in most cases set to 127.0.0.1."}, "DstOriginalRiskLevel": {"type": "string", "description": "The risk level associated with the destination device as reported by the reporting device."}, "DstPortNumber": {"type": "integer", "description": "Destination Port number."}, "DstRiskLevel": {"type": "integer", "description": "The risk level associated with the destination device."}, "Dvc": {"type": "string", "description": "A unique identifier of the device reporting the event. The identifier can be either an IP Address, A hostname, or a device ID."}, "DvcAction": {"type": "string", "description": "The action taken by the the reporting device on the request, such as blocking it."}, "DvcDescription": {"type": "string", "description": "A descriptive text associated with the device. For example: Primary Domain Controller."}, "DvcDomain": {"type": "string", "description": "The domain of the device reporting the event."}, "DvcDomainType": {"type": "string", "description": "The type of DvcDomain. Possible values include \"Windows\" and \"FQDN\"."}, "DvcFQDN": {"type": "string", "description": "The fully qualified hostname, including domain information, of the device reporting the event."}, "DvcHostname": {"type": "string", "description": "The hostname of the device reporting the event."}, "DvcId": {"type": "string", "description": "The unique ID of the device reporting the event."}, "DvcIdType": {"type": "string", "description": "The type of DvcId."}, "DvcInterface": {"type": "string", "description": "The network interface on which data was captured. This field is typically relevant to network related activity which is captured by an intermediate or tap device."}, "DvcIpAddr": {"type": "string", "description": "The IP Address of the device reporting the event."}, "DvcMacAddr": {"type": "string", "description": "The MAC address of the device reporting the event."}, "DvcOriginalAction": {"type": "string", "description": "The original DvcAction as provided by the reporting device."}, "DvcOs": {"type": "string", "description": "The operating system running on the device reporting the event."}, "DvcOsVersion": {"type": "string", "description": "The version of the operating system on the device reporting the event."}, "DvcScope": {"type": "string", "description": "The cloud platform scope the device belongs to. DvcScope map to a subscription ID on Azure and to an account ID on AWS."}, "DvcScopeId": {"type": "string", "description": "The cloud platform scope ID the device belongs to. DvcScopeId map to a subscription ID on Azure and to an account ID on AWS."}, "DvcZone": {"type": "string", "description": "The network segment of the device reporting the event."}, "EventCount": {"type": "integer", "description": "The number of events described by the record. This value is used when the source supports aggregation, and a single record may represent multiple events."}, "EventEndTime": {"$ref": "#/$defs/time", "description": "The time at which the event ended. If the source supports aggregation and the record represents multiple events, the time that the last event was generated. If not provided by the source record, this field aliases the TimeGenerated field."}, "EventMessage": {"type": "string", "description": "A general message or description."}, "EventOriginalSeverity": {"type": "string", "description": "The original severity as provided by the reporting device. This value is used to derive EventSeverity."}, "EventOriginalType": {"type": "string", "description": "The original event type or ID, for example, the original Windows event ID."}, "EventOriginalUid": {"type": "string", "description": "A unique ID of the original record."}, "EventOwner": {"type": "string", "description": "The owner of the event, which is usually the department or subsidiary in which it was generated."}, "EventProduct": {"type": "string", "description": "The product generating the event."}, "EventProductVersion": {"type": "string", "description": "The version of the product generating the event."}, "EventReportUrl": {"type": "string", "description": "A URL of a resource that provides additional information about the event."}, "EventResult": {"type": "string", "description": "The outcome of the event, represented by one of the following values: Success, Partial, Failure, NA (Not Applicable). The value may not be provided directly by the sources, in which case it is derived from other event fields, for example, the EventResultDetails field."}, "EventResultDetails": {"type": "string", "description": "The DNS response code as defined by the Internet Assigned Numbers Authority (IANA)."}, "EventSchemaVersion": {"type": "string", "description": "The version of the schema."}, "EventSeverity": {"type": "string", "description": "The severity of the event. Valid values are: Informational, Low, Medium, or High."}, "EventStartTime": {"$ref": "#/$defs/time", "description": "The time at which the event started. If the source supports aggregation and the record represents multiple events, the time that the first event was generated. If not provided by the source record, this field aliases the TimeGenerated field."}, "EventSubType": {"type": "string", "description": "Either request or response."}, "EventType": {"type": "string", "description": "Indicates the operation reported by the record. For DNS activity events, this value is the DNS opcode as defined by the Internet Assigned Numbers Authority (IANA)."}, "EventVendor": {"type": "string", "description": "The vendor of the product generating the event."}, "NetworkProtocol": {"type": "string", "description": "The transport protocol used by the network resolution event. The value can be UDP or TCP."}, "NetworkProtocolVersion": {"type": "string", "description": "The version of the network protocol. Typically used to differentiate between IPv4 and Ipv6."}, "RuleName": {"type": "string", "description": "The name or ID of the rule by associated with the inspection results."}, "RuleNumber": {"type": "integer", "description": "The number of the rule associated with the inspection results."}, "SourceSystem": {"type": "string", "description": "The type of agent the event was collected by. For example, OpsManager for Windows agent, either direct connect or Operations Manager, Linux for all Linux agents, or Azure for Azure Diagnostics"}, "Src": {"type": "string", "description": "A unique identifier of the source device."}, "SrcDescription": {"type": "string", "description": "The number of the rule associated with the inspection results."}, "SrcDeviceType": {"type": "string", "description": "The type of the source device."}, "SrcDomain": {"type": "string", "description": "The domain of the source device."}, "SrcDomainType": {"type": "string", "description": "The type of SrcDomain."}, "SrcDvcId": {"type": "string", "description": "The ID of the source device."}, "SrcDvcIdType": {"type": "string", "description": "The type of SrcDvcId."}, "SrcDvcScope": {"type": "string", "description": "The cloud platform scope the source device belongs to. DvcScope maps to a subscription on Azure and to an account on AWS."}, "SrcDvcScopeId": {"type": "string", "description": "The cloud platform scope ID the source device belongs to. DvcScopeId map to a subscription ID on Azure and to an account ID on AWS."}, "SrcFQDN": {"type": "string", "description": "The source device hostname, including domain information."}, "SrcGeoCity": {"type": "string", "description": "The city associated with the source IP address."}, "SrcGeoCountry": {"type": "string", "description": "The country associated with the source IP address."}, "SrcGeoLatitude": {"type": "number", "description": "The latitude of the geographical coordinate associated with the source IP address."}, "SrcGeoLongitude": {"type": "number", "description": "The longitude of the geographical coordinate associated with the source IP address."}, "SrcGeoRegion": {"type": "string", "description": "The region, or state, within a country, associated with the source IP address."}, "SrcHostname": {"type": "string", "description": "The source device hostname, excluding domain information."}, "SrcIpAddr": {"type": "string", "description": "The IP address of the client sending the DNS request. For a recursive DNS request, this value would typically be the reporting device, and in most cases, set to 127.0.0.1."}, "SrcOriginalRiskLevel": {"type": "string", "description": "The risk level associated with the source device as reported by the reporting device."}, "SrcOriginalUserType": {"type": "string", "description": "The original source user type, as provided by the source."}, "SrcPortNumber": {"type": "integer", "description": "Source port of the DNS query."}, "SrcProcessGuid": {"type": "string", "description": "A generated unique identifier (GUID) of the process that initiated the DNS request."}, "SrcProcessId": {"type": "string", "description": "The process ID (PID) of the process that initiated the DNS request."}, "SrcProcessName": {"type": "string", "description": "The name of the process that initiated the DNS request."}, "SrcRiskLevel": {"type": "integer", "description": "The risk level associated with the source device."}, "SrcUserId": {"type": "string", "description": "A machine-readable, alphanumeric, unique representation of the source user."}, "SrcUserIdType": {"type": "string", "description": "The type of the ID stored in the SrcUserId field."}, "SrcUsername": {"type": "string", "description": "The Source username, including domain information when available."}, "SrcUsernameType": {"type": "string", "description": "The type of the username stored in the SrcUsername field."}, "SrcUserScope": {"type": "string", "description": "The scope, such as Azure AD tenant, in which SrcUserId and SrcUsername are defined."}, "SrcUserScopeId": {"type": "string", "description": "The ID of the scope, such as Azure AD tenant, in which SrcUserId and SrcUsername are defined."}, "SrcUserSessionId": {"type": "string", "description": "The unique ID of the sign-in session of the source user."}, "SrcUserType": {"type": "string", "description": "The type of the source user."}, "ThreatCategory": {"type": "string", "description": "If a DNS event source also provides DNS security, it may also evaluate the DNS event. For example, it can search for the IP address or domain in a threat intelligence database, and assign the domain or IP address with a Threat Category."}, "ThreatConfidence": {"type": "integer", "description": "The confidence level of the threat identified, normalized to a value between 0 and a 100."}, "ThreatField": {"type": "string", "description": "The field for which a threat was identified. The value is either SrcIpAddr, DstIpAddr, Domain, or DnsResponseName."}, "ThreatFirstReportedTime": {"type": "string", "description": "The first time the IP address or domain were identified as a threat."}, "ThreatFirstReportedTime_d": {"$ref": "#/$defs/time", "description": "The first time the IP address or domain were identified as a threat."}, "ThreatId": {"type": "string", "description": "The ID of the threat or malware identified in the web session."}, "ThreatIpAddr": {"type": "string", "description": "An IP address for which a threat was identified. The field ThreatField contains the name of the field ThreatIpAddr represents. If a threat is identified in the Domain field, this field should be empty."}, "ThreatIsActive": {"type": "boolean", "description": "True ID the threat identified is considered an active threat."}, "ThreatLastReportedTime": {"type": "string", "description": "The last time the IP address or domain were identified as a threat."}, "ThreatLastReportedTime_d": {"$ref": "#/$defs/time", "description": "The last time the IP address or domain were identified as a threat."}, "ThreatName": {"type": "string", "description": "The name of the threat identified, as reported by the reporting device."}, "ThreatOriginalConfidence": {"type": "string", "description": "The original confidence level of the threat identified, as reported by the reporting device."}, "ThreatOriginalRiskLevel": {"type": "integer", "description": "The original risk level associated with the threat identified, as reported by the reporting device."}, "ThreatOriginalRiskLevel_s": {"type": "string", "description": "The risk level associated with the threat identified, normalized to a value between 0 and a 100."}, "ThreatRiskLevel": {"type": "integer", "description": "The risk level associated with the threat identified, normalized to a value between 0 and a 100."}, "TimeGenerated": {"$ref": "#/$defs/time", "description": "The timestamp (UTC) reflecting the time in which the event was generated."}, "TransactionIdHex": {"type": "string", "description": "The DNS unique hex transaction ID."}, "Type": {"type": "string", "description": "The name of the table"}, "UrlCategory": {"type": "string", "description": "A DNS event source may also look up the category of the requested Domains."}}}