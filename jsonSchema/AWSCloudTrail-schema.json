{"$id": "https://example.com/schema/AWSCloudTrail.json", "$schema": "http://json-schema.org/draft-07/schema#", "title": "AWSCloudTrail", "description": "JSON Schema for Log Analytics table: AWSCloudTrail", "type": "object", "required": ["TimeGenerated", "Type"], "$defs": {"time": {"anyOf": [{"type": "string", "format": "date-time"}, {"type": "string", "pattern": "\\d{10}\\.?\\d{0,3}?"}]}}, "properties": {"AdditionalEventData": {"type": "string", "description": "Additional data about the event that was not part of the request or response."}, "APIVersion": {"type": "string", "description": "Identifies the API version associated with the AwsApiCall eventType value."}, "AwsEventId": {"type": "string", "description": "GUID generated by CloudTrail to uniquely identify each event. You can use this value to identify a single event."}, "AWSRegion": {"type": "string", "description": "The AWS region that the request was made to."}, "AwsRequestId": {"type": "string", "description": "deprecated, please use AwsRequestId_ instead."}, "AwsRequestId_": {"type": "string", "description": "The value that identifies the request. The service being called generates this value."}, "Category": {"type": "string", "description": "Shows the event category that is used in LookupEvents calls."}, "CidrIp": {"type": "string", "description": "The CIDR IP is located under RequestParameters in CloudTrail, and it is used to specify the IP permissions for a security group rule. The IPv4 CIDR range."}, "CipherSuite": {"type": "string", "description": "Optional. Part of tlsDetails. The cipher suite (combination of security algorithms used) of a request."}, "ClientProvidedHostHeader": {"type": "string", "description": "Optional. Part of tlsDetails. The client-provided host name used in the service API call, which is typically the FQDN of the service endpoint."}, "DestinationPort": {"type": "string", "description": "The DestinationPort is located under RequestParameters in CloudTrail, and it is used to specify the IP permissions for a security group rule. The end of port range for the TCP and UDP protocols, or an ICMP code."}, "EC2RoleDelivery": {"type": "string", "description": "The friendly name of the user or role that issued the session."}, "ErrorCode": {"type": "string", "description": "The AWS service error if the request returns an error."}, "ErrorMessage": {"type": "string", "description": "The error description when available. This message includes messages for authorization failures. CloudTrail captures the message logged by the service in its exception handling."}, "EventName": {"type": "string", "description": "The requested action, which is one of the actions in the API for that service."}, "EventSource": {"type": "string", "description": "The service that the request was made to. This name is typically a short form of the service name without spaces plus .amazonaws.com."}, "EventTypeName": {"type": "string", "description": "Identifies the type of event that generated the event record. This can be the one of the following values: AwsApiCall, AwsServiceEvent, AwsConsoleAction , AwsConsoleSignIn."}, "EventVersion": {"type": "string", "description": "The version of the log event format."}, "IpProtocol": {"type": "string", "description": "The IP protocol is located under RequestParameters in CloudTrail, and it is used to specify the IP permissions for a security group rule. The IP protocol name or number. The valid values are tcp, udp, icmp, or a protocol number."}, "ManagementEvent": {"type": "boolean", "description": "A Boolean value that identifies whether the event is a management event."}, "OperationName": {"type": "string", "description": "Constant value: CloudTrail."}, "ReadOnly": {"type": "boolean", "description": "Identifies whether this operation is a read-only operation."}, "RecipientAccountId": {"type": "string", "description": "Represents the account ID that received this event. The recipientAccountID may be different from the CloudTrail userIdentity Element accountId. This can occur in cross-account resource access."}, "RequestParameters": {"type": "string", "description": "The parameters, if any, that were sent with the request. These parameters are documented in the API reference documentation for the appropriate AWS service."}, "Resources": {"type": "string", "description": "A list of resources accessed in the event."}, "ResponseElements": {"type": "string", "description": "The response element for actions that make changes (create, update, or delete actions). If an action does not change state (for example, a request to get or list objects), this element is omitted."}, "ServiceEventDetails": {"type": "string", "description": "Identifies the service event, including what triggered the event and the result."}, "SessionCreationDate": {"$ref": "#/$defs/time", "description": "The date and time when the temporary security credentials were issued."}, "SessionIssuerAccountId": {"type": "string", "description": "The account that owns the entity that was used to get credentials."}, "SessionIssuerArn": {"type": "string", "description": "The ARN of the source (account, IAM user, or role) that was used to get temporary security credentials."}, "SessionIssuerPrincipalId": {"type": "string", "description": "The internal ID of the entity that was used to get credentials."}, "SessionIssuerType": {"type": "string", "description": "The source of the temporary security credentials, such as Root, IAMUser, or Role."}, "SessionIssuerUserName": {"type": "string", "description": "The friendly name of the user or role that issued the session."}, "SessionMfaAuthenticated": {"type": "boolean", "description": "The value is true if the root user or IAM user whose credentials were used for the request also was authenticated with an MFA device; otherwise, false."}, "SharedEventId": {"type": "string", "description": "GUID generated by CloudTrail to uniquely identify CloudTrail events from the same AWS action that is sent to different AWS accounts."}, "SourceIpAddress": {"type": "string", "description": "The IP address that the request was made from. For actions that originate from the service console, the address reported is for the underlying customer resource, not the console web server. For services in AWS, only the DNS name is displayed."}, "SourcePort": {"type": "string", "description": "The SourcePort is located under RequestParameters in CloudTrail, and it is used to specify the IP permissions for a security group rule. The start of port range for the TCP and UDP protocols, or an ICMP type number."}, "SourceSystem": {"type": "string", "description": "The type of agent the event was collected by. For example, OpsManager for Windows agent, either direct connect or Operations Manager, Linux for all Linux agents, or Azure for Azure Diagnostics"}, "TimeGenerated": {"$ref": "#/$defs/time", "description": "The timestamp (UTC). An event's time stamp comes from the local host that provides the service API endpoint on which the API call was made."}, "TlsVersion": {"type": "string", "description": "Optional. Part of tlsDetails. The TLS version of a request."}, "Type": {"type": "string", "description": "The name of the table", "enum": ["AWSCloudTrail"]}, "UserAgent": {"type": "string", "description": "The agent through which the request was made, such as the AWS Management Console, an AWS service, the AWS SDKs or the AWS CLI."}, "UserIdentityAccessKeyId": {"type": "string", "description": "The access key ID that was used to sign the request."}, "UserIdentityAccountId": {"type": "string", "description": "The account that owns the entity that granted permissions for the request."}, "UserIdentityArn": {"type": "string", "description": "The Amazon Resource Name (ARN) of the principal that made the call."}, "UserIdentityInvokedBy": {"type": "string", "description": "The name of the AWS service that made the request."}, "UserIdentityPrincipalid": {"type": "string", "description": "A unique identifier for the entity that made the call."}, "UserIdentityType": {"type": "string", "description": "The type of the identity. The following values are possible: Root, IAMUser, AssumedRole, FederatedUser, Directory, AWSAccount, AWSService, Unknown."}, "UserIdentityUserName": {"type": "string", "description": "The name of the identity that made the call."}, "VpcEndpointId": {"type": "string", "description": "Identifies the VPC endpoint in which requests were made from a VPC to another AWS service."}}}